metadata:
  name: consumer
  labels:
    nuclio.io/project-name: sciot
spec:
  description: "Showcases unstructured logging and a structured response."
  handler: "helloworld:handler"
  runtime: "python:3.8"
  resources: {}
  minReplicas: 1
  maxReplicas: 1
  triggers:
    default-http:
      class: ""
      kind: http
      name: default-http
      maxWorkers: 1
    rabbitmq:
      class: ""
      kind: rabbit-mq
      name: rabbitmq
      url: "amqp://guest:guest@172.17.0.1:5672"
      attributes:
        exchangeName: livescore
        queueName: livescore_queue
  version: 1
  build:
    functionSourceCode: ICAgICMgQ29weXJpZ2h0IDIwMTcgVGhlIE51Y2xpbyBBdXRob3JzLgogICAgIwogICAgIyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICAgICMgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogICAgIyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICAgICMKICAgICMgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAgICAjCiAgICAjIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICAgICMgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICAgICMgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAgICAjIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICAgICMgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCmltcG9ydCB0ZWxlZ3JhbSBhcyBsaWJyCmltcG9ydCBwaWthCmltcG9ydCBqc29uCmltcG9ydCBjb3B5CgpteV90b2tlbiA9ICcyMTEwNjA0MzgzOkFBR0F5Y1doemU2RkNHVk5xR0EzQTlKTm1kNm5NUDd3bVhVJwpteV90ZWxlZ3JhbV9JRCA9IDM0MzU3NjcwNwpmbGFnID0gRmFsc2UKbXlkaWN0ID0gW10KCnBhcmFtcyA9IHBpa2EuQ29ubmVjdGlvblBhcmFtZXRlcnMoaG9zdD0iMTcyLjE3LjAuMSIpCmNvbm5lY3Rpb24gPSBwaWthLkJsb2NraW5nQ29ubmVjdGlvbihwYXJhbXMpCmNoYW5uZWwgPSBjb25uZWN0aW9uLmNoYW5uZWwoKQoKY2hhbm5lbC5xdWV1ZV9kZWNsYXJlKHF1ZXVlID0gJ2xpdmVzY29yZV9xdWV1ZScpCgpjaGFubmVsLmV4Y2hhbmdlX2RlY2xhcmUoZXhjaGFuZ2U9J2xpdmVzY29yZScsIGV4Y2hhbmdlX3R5cGU9J2RpcmVjdCcpCgpjaGFubmVsLnF1ZXVlX2JpbmQoZXhjaGFuZ2U9J2xpdmVzY29yZScsIHF1ZXVlPSJsaXZlc2NvcmVfcXVldWUiKQoKZGVmIHNlbmQobXNnLCBjaGF0X2lkLCB0b2tlbj1teV90b2tlbik6Cglib3QgPSBsaWJyLkJvdCh0b2tlbj10b2tlbikKCWJvdC5zZW5kTWVzc2FnZShjaGF0X2lkPWNoYXRfaWQsIHRleHQ9bXNnKQoKZGVmIGhhbmRsZXIoY29udGV4dCwgZXZlbnQpOgogICAgY29udGV4dC5sb2dnZXIuaW5mbygnVGhpcyBpcyBhbiB1bnN0cnVjdHVyZWQgbG9nJykKICAgIGdsb2JhbCBteWRpY3QKICAgIGdsb2JhbCBmbGFnCiAgICByZXMgPSBqc29uLmxvYWRzKGV2ZW50LmJvZHkuZGVjb2RlKCkpCiAgICBpZiByZXMgaXMgTm9uZToKICAgICAgICBpZiBteWRpY3Q6CiAgICAgICAgICAgIGZvciBnYW1lIGluIG15ZGljdDoKICAgICAgICAgICAgICAgIG1zZyA9IGdhbWVbImhvbWUiXSArICIgIiArIHN0cihnYW1lWyJoc2NvcmUiXSkgKyAiIC0gIiArIHN0cihnYW1lWyJhc2NvcmUiXSkgKyAiICIgKyBnYW1lWyJhd2F5Il0KICAgICAgICAgICAgICAgIHNlbmQoIlxuVEhJUyBNQVRDSCBJUyBPVkVSOlxuIiArIG1zZywgbXlfdGVsZWdyYW1fSUQpCiAgICAgICAgc2VuZCgiXG5cblRIRVJFIEFSRSBOTyBMSVZFIE1BVENIRVMhXG4iLCBteV90ZWxlZ3JhbV9JRCkKICAgICAgICBteWRpY3QgPSBbXQogICAgZWxzZToKICAgICAgICBpZiBmbGFnID09IFRydWU6CiAgICAgICAgICAgIGlzX3ByZXNlbnQ9MAogICAgICAgICAgICBmb3IgcHJldmlvdXNfZ2FtZSBpbiBteWRpY3Q6CiAgICAgICAgICAgICAgICBmb3IgZ2FtZSBpbiByZXM6CiAgICAgICAgICAgICAgICAgICAgaWYgcHJldmlvdXNfZ2FtZVsiaG9tZSJdPT1nYW1lWyJob21lIl06CiAgICAgICAgICAgICAgICAgICAgICAgIGlzX3ByZXNlbnQ9MQogICAgICAgICAgICAgICAgICAgICAgICBpZiBnYW1lWyJoc2NvcmUiXSAhPSBwcmV2aW91c19nYW1lWyJoc2NvcmUiXSBvciBnYW1lWyJhc2NvcmUiXSAhPSBwcmV2aW91c19nYW1lWyJhc2NvcmUiXToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZyA9ICJNaW51dGU6ICIgKyBzdHIoZ2FtZVsibWludXRlIl0pICsgIlxuIiArZ2FtZVsiaG9tZSJdICsgIiAiICsgc3RyKGdhbWVbImhzY29yZSJdKSArICIgLSAiICsgc3RyKGdhbWVbImFzY29yZSJdKSArICIgIiArIGdhbWVbImF3YXkiXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZCgiXG5cbkdPT09PT09PT09MXG4iICsgbXNnLCBteV90ZWxlZ3JhbV9JRCkKICAgICAgICAgICAgICAgIGlmIGlzX3ByZXNlbnQgPT0gMDoKICAgICAgICAgICAgICAgICAgICBtc2cgPSBwcmV2aW91c19nYW1lWyJob21lIl0gKyAiICIgKyBzdHIocHJldmlvdXNfZ2FtZVsiaHNjb3JlIl0pICsgIiAtICIgKyBzdHIocHJldmlvdXNfZ2FtZVsiYXNjb3JlIl0pICsgIiAiICsgcHJldmlvdXNfZ2FtZVsiYXdheSJdCiAgICAgICAgICAgICAgICAgICAgc2VuZCgiXG5USElTIE1BVENIIElTIE9WRVI6XG4iICsgbXNnLCBteV90ZWxlZ3JhbV9JRCkgCiAgICAgICAgICAgICAgICBpc19wcmVzZW50ID0gMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGZsYWcgPSBUcnVlCgogICAgICAgIG15ZGljdCA9IGNvcHkuZGVlcGNvcHkocmVzKQogICAgICAgIHByaW50KG15ZGljdCkKICAgICAgICAK
    commands:
      - 'pip install python-telegram-bot'
      - 'pip install pika'
      - 'pip install jsonpickle'
    runtimeAttributes:
      repositories: []
    codeEntryType: sourceCode
    timestamp: 1637081387
  loggerSinks:
    - level: debug
  platform: {}
  securityContext: {}
  eventTimeout: ""
